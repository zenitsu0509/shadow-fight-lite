<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Shadow Fight Lite</title>
  <link rel="icon" href="https://image.flaticon.com/icons/png/512/31/31702.png">
  <!-- *** Ensure these paths are correct *** -->
  <link rel="stylesheet" href="frontend/assets/stylesheets/main_page.css">
  <link rel="stylesheet" href="frontend/assets/stylesheets/reset.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
  <link href="https://fonts.googleapis.com/css?family=Oxygen:300,400" rel="stylesheet">

  <style>
    /* ... (keep the existing modal styles) ... */
    .background-grid { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; padding: 20px; max-height: 70vh; overflow-y: auto; }
    .background-option { border: 3px solid #444; border-radius: 8px; overflow: hidden; cursor: pointer; transition: transform 0.2s ease-in-out, border-color 0.2s ease-in-out; background-color: #222; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); }
    .background-option:hover { transform: scale(1.05); border-color: #00bcd4; }
    .background-option img { width: 200px; height: 120px; object-fit: cover; display: block; }
    .background-option span { display: block; padding: 8px; text-align: center; font-size: 0.9em; color: #eee; }
    .modal-background.hidden { display: none; }
    .modal-background { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7); display: flex; justify-content: center; align-items: center; z-index: 100; }
    .modal-child { background-color: #1a1a1a; padding: 20px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5); max-width: 90%; max-height: 90%; overflow-y: auto; position: relative; }
    .modal-child h2, .modal-child h3 { text-align: center; margin-bottom: 20px; color: #eee; } /* Applied h3 style too */
    .close-modal-btn { position: absolute; top: 10px; right: 15px; font-size: 1.8em; color: #aaa; cursor: pointer; background: none; border: none; }
    .close-modal-btn:hover { color: #fff; }
  </style>
  <script src="bundle.js" defer></script>
</head>
<body>
  <main id="root">
    <!-- Existing Demo/Help Modal -->
    <section class="modal-background hidden" id="info-modal">
      <section class="modal-child">
         <button class="close-modal-btn" onclick="closeModal('info-modal')">×</button>
        <section class="demo-open hidden">
          <div class="demo-description">
            <h2>Gameplay Demo</h2>
            <h4>Note: Game is designed for a full keyboard with numpad</h4>
          </div>
          <img src="./docs/gifs/gameplay.gif" alt="gameplay">
        </section>
        <section class="help-open hidden">
          <h2>Controls</h2>
          <div class="player1-controls">
            <h4>Player 1:</h4>
            <h5>W A S D --- (up, left, down, right) movement</h5>
            <h5>J --- attack</h5>
          </div>
          <div class="player2-controls">
            <h4>Player 2:</h4>
            <h5>↑ ← ↓ → --- (up, left, down, right) movement</h5>
            <h5>Right shift --- attack</h5>
          </div>
        </section>
      </section>
    </section>

    <!-- Background Select Modal -->
    <section class="modal-background hidden" id="background-select-modal">
        <section class="modal-child">
            <button class="close-modal-btn" onclick="closeModal('background-select-modal')">×</button>
            <h3>Select Your Background</h3> {/* Changed h2 to h3 for consistency maybe */}
            <div class="background-grid" id="backgroundGridContainer">
                <!-- Background options will be inserted here by JavaScript -->
            </div>
        </section>
    </section>

    <nav class="nav-bar-container">
      <div class="header-text">
        <h1>Shadow Fight Lite</h1>
      </div>
      <div class="icons">
        <!-- Demo Icon -->
        <div class="demo-icon-container" onclick="openModal('info-modal', '.demo-open')">
          <h5>Gameplay demo</h5>
          <i class="fas fa-video fa-2x"></i>
        </div>
        <!-- Controls Icon -->
        <div class="help-icon-container" onclick="openModal('info-modal', '.help-open')">
          <h5>Controls</h5>
          <i class="far fa-question-circle fa-2x"></i>
        </div>

        <!-- ***** ALIGNED BACKGROUND SELECT ICON ***** -->
        <!-- Use the same class as other icons and remove inline style -->
        <div class="help-icon-container" onclick="openBackgroundModal()" style="cursor: pointer;"> <!-- Keep cursor:pointer, maybe remove others -->
          <h5>Select Background</h5>
          <i class="fas fa-image fa-2x"></i>
        </div>
        <!-- ***** END ALIGNMENT FIX ***** -->

        <!-- GitHub Link -->
        <a href="https://github.com/zenitsu0509/shadow-fight-lite" target="_blank" rel="noopener noreferrer">
          <i class="fab fa-github-square fa-2x"></i>
        </a>
      </div>
    </nav>
    <section class="canvas-container">
      <canvas id="canvas" width="1051.7" height="650"></canvas>
    </section>
  </main>

  <!-- Combined Modal Logic -->
  <script>
      // --- Modal Handling ---
      function openModal(modalId, contentSelector = null) { /* ... Keep existing JS ... */ }
      function closeModal(modalId) { /* ... Keep existing JS ... */ }
      document.querySelectorAll('.modal-background').forEach(modalBg => { /* ... Keep existing JS ... */ });

      // --- Background Selection Specific Logic ---
      const backgrounds = [ /* ... Keep existing JS ... */ ];
      const backgroundImagePath = 'frontend/assets/images/';
      const backgroundGridContainer = document.getElementById('backgroundGridContainer');
      let backgroundModalPopulated = false;
      function populateBackgroundModal() { /* ... Keep existing JS ... */ }
      function openBackgroundModal() { /* ... Keep existing JS ... */ }

      // --- DOM Ready ---
      document.addEventListener('DOMContentLoaded', () => { /* ... Keep existing JS ... */ });
  </script>
</body>
</html>
